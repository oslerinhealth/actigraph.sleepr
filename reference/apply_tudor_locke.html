<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply the Tudor-Locke algorithm — apply_tudor_locke • actigraph.sleepr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Apply the Tudor-Locke algorithm — apply_tudor_locke" />
<meta property="og:description" content="The Tudor-Locke algorithm detects periods of time in bed and, for
each period, computes sleep quality metrics such as total minutes in
 bed, total sleep time, number and average length of awakenings,
 movement and fragmentation index." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">actigraph.sleepr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/detect-nonwear.html">Non-wear detection from ActiGraph data</a>
    </li>
    <li>
      <a href="../articles/detect-sleep.html">Sleep detection from ActiGraph data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/dipetkov/actigraph.sleepr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply the Tudor-Locke algorithm</h1>
    <small class="dont-index">Source: <a href='http://github.com/dipetkov/actigraph.sleepr/blob/master/R/apply_tudor_locke.R'><code>R/apply_tudor_locke.R</code></a></small>
    <div class="hidden name"><code>apply_tudor_locke.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Tudor-Locke algorithm detects periods of time in bed and, for
each period, computes sleep quality metrics such as total minutes in
 bed, total sleep time, number and average length of awakenings,
 movement and fragmentation index.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>apply_tudor_locke</span><span class='op'>(</span>
  <span class='va'>agdb</span>,
  n_bedtime_start <span class='op'>=</span> <span class='fl'>5</span>,
  n_wake_time_end <span class='op'>=</span> <span class='fl'>10</span>,
  min_sleep_period <span class='op'>=</span> <span class='fl'>160</span>,
  max_sleep_period <span class='op'>=</span> <span class='fl'>1440</span>,
  min_nonzero_epochs <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>agdb</th>
      <td><p>A <code>tibble</code> (<code>tbl</code>) of activity data (at least)
an <code>epochlength</code> attribute. The epoch length must be 60 seconds.
Each epoch should be scored as asleep (S) or awake (W), using the Sadeh,
the Cole-Kripke or a custom algorithm.</p></td>
    </tr>
    <tr>
      <th>n_bedtime_start</th>
      <td><p>Bedtime definition, in minutes. The default is 5.</p></td>
    </tr>
    <tr>
      <th>n_wake_time_end</th>
      <td><p>Wake time definition, in minutes. The default is 10.</p></td>
    </tr>
    <tr>
      <th>min_sleep_period</th>
      <td><p>Minimum sleep period length, in minutes.
The default is 160.</p></td>
    </tr>
    <tr>
      <th>max_sleep_period</th>
      <td><p>Maximum sleep period length, in minutes.
The default is 1440 (24 hours).</p></td>
    </tr>
    <tr>
      <th>min_nonzero_epochs</th>
      <td><p>Minimum number of epochs with non-zero
activity. The default is 0.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A summary <code>tibble</code> of the detected sleep periods.
If the activity data is grouped, then sleep periods are detected
separately for each group.</p><dl>
  <dt>in_bed_time</dt><dd><p>The first minute of the bedtime.</p></dd>
  <dt>out_bed_time</dt><dd><p>The first minute of wake time.</p></dd>
  <dt>onset</dt><dd><p>The first minute that the algorithm scores "asleep".</p></dd>
  <dt>latency</dt><dd><p>The time elapsed between bedtime and sleep onset.
  By the definition of Tudor-Locke, latency is 0.</p></dd>
  <dt>efficiency</dt><dd><p>The number of sleep minutes divided
  by the bedtime minutes.</p></dd>
  <dt>duration</dt><dd><p>The duration of the sleep period, in minutes.</p></dd>
  <dt>activity_counts</dt><dd><p>The sum of activity counts for the entire
  sleep period.</p></dd>
  <dt>total_sleep_time</dt><dd><p>The number of minutes scored as "asleep"
  during the sleep period.</p></dd>
  <dt>wake_after_onset</dt><dd><p>The number of minutes scored as "awake",
   minus the sleep latency, during the sleep period.</p></dd>
  <dt>nb_awakenings</dt><dd><p>The number of awakening episodes.</p></dd>
  <dt>ave_awakening</dt><dd><p>The average length, in minutes, of all
  awakening episodes.</p></dd>
  <dt>movement_index</dt><dd><p>Proportion of awake time out of the total
  time in bed, in percentages.</p></dd>
  <dt>fragmentation_index</dt><dd><p>Proportion of one-minute sleep bouts
  out of the number of sleep bouts of any length, in percentages.</p></dd>
  <dt>sleep_fragmentation_index</dt><dd><p>The sum of the movement and
  fragmentation indices.</p></dd>
  <dt>nonzero_epochs</dt><dd><p>The number of epochs with activity &gt; 0
  (nonzero epochs).</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Once each one-minute epoch is labeled as asleep (S) or awake (W),
we can use the Tudor-Locke algorithm to detect periods of
<em>bedtime</em> and <em>sleep time</em>. By definition, <em>sleep time</em> &lt;
<em>bedtime</em> since one can be in bed and not sleeping.</p>
<p>Bedtime is (the first minute of) <code>n_bedtime_start</code> consecutive
epochs/minutes labeled asleep (S). Similarly, wake time is
(the first minute of) of <code>n_wake_time_end</code> consecutive
epochs/minutes labeled awake (W), after a period of sleep.
The block of time between bedtime and wake time is one sleep
period, if the time elapsed is at least <code>min_sleep_period</code>
minutes. There can be multiple sleep periods in 24 hours but a
sleep period cannot be longer than <code>max_sleep_period</code> minutes.</p>
<p>For each sleep period, the algorithm calculates several measures of
sleep quality such as time asleep and time awake, number and average
length of awakenings, and movement and fragmentation indices.</p>
<p>This implementation of the Tudor-Locke algorithm detects all the sleep
periods that ActiLife detects and, in some cases, it detects
<em>additional</em> sleep periods. There are (at least) two such cases:</p><ol>
<li><p>ActiLife filters out some sleep periods with <em>exactly</em>
  <code>min_nonzero_epochs</code> nonzero epochs. Alternatively, ActiLife
  computes the number of nonzero epochs in a sleep period differently
  and sometimes underestimates <code>nonzero_epochs</code> compared to
  <code>apply_tudor_locke</code>.</p></li>
<li><p>ActiLife filters out sleep periods that end when the activity
  data ends, i.e., when the <code>out_bed_time</code> is also the final
  timestamp in the <code>agdb</code> table.</p></li>
</ol>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>C Tudor-Locke, TV Barreira, JM Schuna Jr, EF Mire and
PT Katzmarzyk. Fully automated waist-worn accelerometer algorithm
for detecting children's sleep-period time separate from 24-h
physical activity or sedentary behaviors. <em>Applied Physiology</em>,
 Nutrition, and Metabolism, 39(1):53–57, 2014.</p>
<p>ActiLife 6 User's Manual by the ActiGraph Software
Department. 04/03/2012.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='apply_sadeh.html'>apply_sadeh</a></code>, <code><a href='apply_cole_kripke.html'>apply_cole_kripke</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://dplyr.tidyverse.org'>"dplyr"</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://lubridate.tidyverse.org'>"lubridate"</a></span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Attaching package: ‘lubridate’</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     date, intersect, setdiff, union</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"gtxplus1day"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Detect sleep periods using Sadeh as the sleep/awake algorithm</span></span>
<span class='r-in'><span class='co'># and Tudor-Locke as the sleep period algorithm</span></span>
<span class='r-in'><span class='va'>agdb</span> <span class='op'>&lt;-</span> <span class='va'>gtxplus1day</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='collapse_epochs.html'>collapse_epochs</a></span><span class='op'>(</span><span class='fl'>60</span><span class='op'>)</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/day.html'>day</a></span><span class='op'>(</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>28</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>periods_sleep</span> <span class='op'>&lt;-</span> <span class='va'>agdb</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='apply_sadeh.html'>apply_sadeh</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>apply_tudor_locke</span><span class='op'>(</span>min_sleep_period <span class='op'>=</span> <span class='fl'>60</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>periods_sleep</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           in_bed_time        out_bed_time               onset latency</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 2012-06-28 00:00:00 2012-06-28 07:38:00 2012-06-28 00:00:00       0</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 2012-06-28 09:41:00 2012-06-28 10:53:00 2012-06-28 09:41:00       0</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   efficiency duration activity_counts nonzero_epochs total_sleep_time</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1   97.16157      458            9126             27              445</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2   84.72222       72           10662             24               61</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   wake_after_onset nb_awakenings ave_awakening movement_index</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1               13             4          3.25       5.895197</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2               11             2          5.50      33.333333</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   fragmentation_index sleep_fragmentation_index</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                  40                  45.89520</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2                   0                  33.33333</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Group and summarize by an extra varible (hour &lt; 6 or not), which</span></span>
<span class='r-in'><span class='co'># splits one long sleep period in two</span></span>
<span class='r-in'><span class='va'>agdb</span> <span class='op'>&lt;-</span> <span class='va'>agdb</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>hour_lt6 <span class='op'>=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/hour.html'>hour</a></span><span class='op'>(</span><span class='va'>timestamp</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>6</span><span class='op'>)</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>hour_lt6</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>periods_sleep</span> <span class='op'>&lt;-</span> <span class='va'>agdb</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='apply_sadeh.html'>apply_sadeh</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='pipe.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>apply_tudor_locke</span><span class='op'>(</span>min_sleep_period <span class='op'>=</span> <span class='fl'>60</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>periods_sleep</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># A tibble: 3 x 16</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># Groups:   hour_lt6 [2]</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   hour_lt6 in_bed_time         out_bed_time        onset               latency</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   <span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;dttm&gt;</span><span>              </span><span style='color: #949494;font-style: italic;'>&lt;dttm&gt;</span><span>              </span><span style='color: #949494;font-style: italic;'>&lt;dttm&gt;</span><span>                </span><span style='color: #949494;font-style: italic;'>&lt;int&gt;</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>1</span><span> FALSE    2012-06-28 </span><span style='color: #949494;'>06:00:00</span><span> 2012-06-28 </span><span style='color: #949494;'>07:38:00</span><span> 2012-06-28 </span><span style='color: #949494;'>06:00:00</span><span>       0</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>2</span><span> FALSE    2012-06-28 </span><span style='color: #949494;'>09:41:00</span><span> 2012-06-28 </span><span style='color: #949494;'>10:53:00</span><span> 2012-06-28 </span><span style='color: #949494;'>09:41:00</span><span>       0</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>3</span><span> TRUE     2012-06-28 </span><span style='color: #949494;'>00:00:00</span><span> 2012-06-28 </span><span style='color: #949494;'>06:00:00</span><span> 2012-06-28 </span><span style='color: #949494;'>00:00:00</span><span>       0</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># … with 11 more variables: efficiency &lt;dbl&gt;, duration &lt;int&gt;,</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'>#   activity_counts &lt;int&gt;, nonzero_epochs &lt;int&gt;, total_sleep_time &lt;int&gt;,</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'>#   wake_after_onset &lt;int&gt;, nb_awakenings &lt;int&gt;, ave_awakening &lt;dbl&gt;,</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'>#   movement_index &lt;dbl&gt;, fragmentation_index &lt;dbl&gt;,</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'>#   sleep_fragmentation_index &lt;dbl&gt;</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Desislava Petkova.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


